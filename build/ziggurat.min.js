var create_math_function,fun,j,key,len,ref,zg;if(typeof HTML=="undefined"||HTML===null)throw new Error("can't find HTML. did you forget to import imperative-html?");zg={},zg.query=function(e){var t=document.querySelectorAll(e);return t.length===1?t[0]:t},zg.queryone=function(e){return document.querySelector(e)},zg.queryall=function(e){return document.querySelectorAll(e)},zg.deepfind=function(e,t){var n,s,o,i,a;t=t.trim(),o=function(){var e,n,o=t.split("."),i=[];for(e=0,n=o.length;e<n;e++)s=o[e],s!==""&&i.push(s);return i}();for(n=0,a=o.length;n<a;n++)if(i=o[n],e=e[i],e==null)throw new Error(`'${t}' not in data '${e}'`);return e},zg.evalwith=function(e,t){return function(){return eval(e)}.call(t)},zg.VERSION="0.8.1",zg._INIT_LIST=[],zg.init=function(){var e,t,n,s=zg._INIT_LIST;for(e=0,n=s.length;e<n;e++)t=s[e],t();return console.log(`%cZiggurat ${zg.VERSION} initialized.`,"color: orange; font-weight: bold")},zg.formdata=function(e){var t={};return new FormData(e).forEach(function(n,s){return Object.defineProperty(t,s,{get:function(){return e[s].value},set:function(t){return e[s].value=t}})}),t},zg._INIT_LIST.push(function(){var e,t,n,s,o=zg.queryall("form[zg-submit]"),i=[];for(t=0,s=o.length;t<s;t++)e=o[t],n=e.getAttribute("zg-submit"),i.push(e.onsubmit=function(t){var s;try{window[n](zg.formdata(e))}catch(e){s=e,console.error(s)}return t.preventDefault,!1});return i}),zg.mirror=class{constructor(e,t,n,s){this.name=e,Object.defineProperty(this,"v",{get:function(){return this._value},set:function(e){return this._value=e,this.update()}}),this.setters=n||[],this.options=s,this.v=t}update(){var e,t,o,n=this.setters,s=[];for(e=0,t=n.length;e<t;e++)o=n[e],s.push(o(this._value,this.name,this.options));return s}},zg.mirror_to_document=function(e,t){var n,s,o,i,a,r,c,l,d,u,h=zg.queryall(`zg-bind[name=${t}]`);for(s=0,d=h.length;s<d;s++)i=h[s],n=i.getAttribute("script"),i.innerText=n!=null?zg.evalwith(n,e):e;a=zg.queryall(`zg-when[name=${t}]`),r=[];for(o=0,u=a.length;o<u;o++)l=a[o],c=!1,n=l.getAttribute("script"),n!=null&&(c=zg.evalwith(n,e)),r.push(l.hidden=!c);return r},zg.mirror_to_localstorage=function(e,t){return localStorage[t]=e},zg.mirror_to_console=function(e,t){return console.debug(`ziggurat: mirror ${t} = '${e}'`)},zg.cookies=new Proxy({},{get:function(e,t){var n,s,i,o=function(){var e,t,s=document.cookie.split("; "),o=[];for(e=0,t=s.length;e<t;e++)n=s[e],o.push(n.split("="));return o}();for(s=0,i=o.length;s<i;s++)if(n=o[s],n[0]===t)return n[1]},set:function(e,t,n){var s,o,i;return typeof n=="object"?(o=`${t}=${n.value}; `,o+=function(){var e;if(s!=="value"){e=[];for(s in n)i=n[s],e.push(i!=null?`${s} = ${i}`:`${s}`);return e}}().join("; ")):o=`${t}=${n}`,document.cookie=o}}),zg.load_json_cookie=function(e){var t,n=zg.cookies[e];try{return JSON.parse(n)}catch(e){return t=e,null}},zg.mirror_to_cookie=function(e,t,n){return zg.cookies[t]={value:JSON.stringify(e),...n}},Number.prototype.nanos=function(){return this.micros()/1e3},Number.prototype.micros=function(){return this.millis()/1e3},Number.prototype.millis=function(){return this.seconds()/1e3},Number.prototype.seconds=function(){return this},Number.prototype.minutes=function(){return this.seconds()*60},Number.prototype.hours=function(){return this.minutes()*60},Number.prototype.days=function(){return this.hours()*24},Number.prototype.months=function(){return this.days()*30.43684914},Number.prototype.years=function(){return this.months()*12},Number.prototype.ago=function(){return new Date(Date.now()-this*1e3)},Number.prototype.fromnow=function(){return new Date(Date.now()+this*1e3)},create_math_function=function(e){return function(){return this(Math[e])}},ref=Object.getOwnPropertyNames(Math);for(j=0,len=ref.length;j<len;j++)key=ref[j],fun=Math[key],fun.length===1&&typeof fun=="function"&&eval(`Number.prototype.${key} = function() {return Math.${key}(this)}`);zg.stream={},zg.HttpException=class HttpException extends Error{constructor(e){super(`Recieved code ${e} from server`),this.status=e}},zg.stream.text=async function*(e,t){if(n=await fetch(e,t),!n.ok)throw new zg.HttpException(n.statusCode);for(var n,s,o,a=n.body.getReader(),i=new TextDecoder;!0;)if(o=await a.read(),s=i.decode(o.value),s.length>0&&(yield s),o.done)return},zg.stream.lines=async function*(e,t){var n,s,o,a,r,c,i="",l=zg.stream.text(e,t);for await(r of l)i+=r,n=i.split(`
`),n.length>1&&(yield n[0],n=n.slice(1),i=n.join(`
`));o=[];for(s=0,c=n.length;s<c;s++)a=n[s],a.length>0?o.push(yield a):o.push(void 0);return o},zg.stream.jsonl=async function*(e,t){var n,o=zg.stream.lines(e,t),s=[];for await(n of o)try{s.push(yield JSON.parse(n))}catch{}return s},zg.create=function(e,t){var n,s=zg.queryone("zg-template#"+e);if(s==null)throw new TypeError("no such template with name "+e);return n=function(e,t){var s,o,i,a,r,c,l,h=e.cloneNode(!0),d=[],u=h.childNodes;for(r=0,l=u.length;r<l;r++){switch(s=u[r],c=function(e){return e.replace(/\\?\$\{(.+?)\}/g,function(e,n){return e.startsWith("\\")?e:zg.evalwith(n,t)})},s.nodeName.toLowerCase()){case"zg-if":zg.evalwith(s.getAttribute("script"),t)||(s=document.createTextNode(""))}if(s.nodeName==="#text")s.data=c(s.data);else for(a=o=0,i=s.attributes.length;0<=i?o<i:o>i;a=0<=i?++o:--o)s.attributes[a]=c(s.attributes[a].value);s.children!=null&&s.replaceChildren(...n(s,t)),d.push(s)}return d},HTML.div(n(s,t))},zg.multimirror=class{push(e){var t,n,s,o;this.v.push(e),n=zg.queryall(`zg-multibind[name=${this.name}]`);for(t=0,o=n.length;t<o;t++)s=n[t],s.appendChild(zg.create(this.template,e));return e}insert(e,t){var n,s,o,i;this.v.splice(t,0,e),t===-1&&this.push(e),o=zg.queryall(`zg-multibind[name=${this.name}]`);for(n=0,i=o.length;n<i;n++)s=o[n],s.appendBefore(s.children[t],zg.create(this.template,e));return e}delete(e){var t,n,s,o,i;if(e<0?this.v.length- -e:e,e<this.v.length){this.v.splice(e,1),s=zg.queryall(`zg-multibind[name=${this.name}]`),o=[];for(t=0,i=s.length;t<i;t++)n=s[t],o.push(n.removeChild(n.children[e]));return o}}clear(){var e,t,n,s,o;this.v=[],t=zg.queryall(`zg-multibind[name=${this.name}]`),n=[];for(e=0,o=t.length;e<o;e++)s=t[e],n.push(s.innerHTML="");return n}pop(){return delete-1}constructor(e,t,n){var s,o,i;if(this.name=e,this.template=t,this.v=[],n!=null)for(s=0,i=n.length;s<i;s++)o=n[s],this.push(o)}}