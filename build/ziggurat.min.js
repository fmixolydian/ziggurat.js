var create_math_function,fun,i,key,len,ref,zg;if(typeof HTML=="undefined"||HTML===null)throw new Error("can't find HTML. did you forget to import imperative-html?");zg={},zg.query=function(e){var t=document.querySelectorAll(e);return t.length===1?t[0]:t},zg.queryone=function(e){return document.querySelector(e)},zg.queryall=function(e){return document.querySelectorAll(e)},zg.deepfind=function(e,t){var n,s,o,i,a;t=t.trim(),o=function(){var e,n,o=t.split("."),i=[];for(e=0,n=o.length;e<n;e++)s=o[e],s!==""&&i.push(s);return i}();for(n=0,a=o.length;n<a;n++)if(i=o[n],e=e[i],e==null)throw new Error(`'${t}' not in data '${e}'`);return e},zg.VERSION="0.6.3",zg._INIT_LIST=[],zg.init=function(){var e,t,n,s=zg._INIT_LIST;for(e=0,n=s.length;e<n;e++)t=s[e],t();return console.log(`%cZiggurat ${zg.VERSION} initialized.`,"color: orange; font-weight: bold")},zg.formdata=function(e){var t={};return new FormData(e).forEach(function(n,s){return Object.defineProperty(t,s,{get:function(){return e[s].value},set:function(t){return e[s].value=t}})}),t},zg._INIT_LIST.push(function(){var e,t,n,s,o=zg.queryall("form[zg-submit]"),i=[];for(t=0,s=o.length;t<s;t++)e=o[t],n=e.getAttribute("zg-submit"),i.push(e.onsubmit=function(t){var s;try{window[n](zg.formdata(e))}catch(e){s=e,console.error(s)}return t.preventDefault,!1});return i}),zg.mirror=class{constructor(e,t,n,s){this.name=e,Object.defineProperty(this,"v",{get:function(){return this._value},set:function(e){return this._value=e,this.update()}}),this.setters=n||[],this.options=s,this.v=t}update(){var e,t,o,n=this.setters,s=[];for(e=0,t=n.length;e<t;e++)o=n[e],s.push(o(this._value,this.name,this.options));return s}},zg.mirror_to_document=function(e,t){var n,s,o,i,a,r,c,l,d,u,h=zg.queryall(`zg-bind[name=${t}]`);for(s=0,d=h.length;s<d;s++)i=h[s],n=i.getAttribute("script"),i.innerText=n!=null?function(){return eval(n)}.call(e):e;a=zg.queryall(`zg-when[name=${t}]`),r=[];for(o=0,u=a.length;o<u;o++)l=a[o],c=!1,n=l.getAttribute("script"),n!=null&&(c=function(){return eval(n)}.call(e)),r.push(l.hidden=!c);return r},zg.mirror_to_localstorage=function(e,t){return localStorage[t]=e},zg.mirror_to_console=function(e,t){return console.debug(`ziggurat: mirror ${t} = '${e}'`)},zg.cookies=new Proxy({},{get:function(e,t){var n,s,i,o=function(){var e,t,s=document.cookie.split("; "),o=[];for(e=0,t=s.length;e<t;e++)n=s[e],o.push(n.split("="));return o}();for(s=0,i=o.length;s<i;s++)if(n=o[s],n[0]===t)return n[1]},set:function(e,t,n){var s,o,i;return typeof n=="object"?(o=`${t}=${n.value}; `,o+=function(){var e;if(s!=="value"){e=[];for(s in n)i=n[s],e.push(i!=null?`${s} = ${i}`:`${s}`);return e}}().join("; ")):o=`${t}=${n}`,document.cookie=o}}),zg.load_json_cookie=function(e){var t,n=zg.cookies[e];try{return JSON.parse(n)}catch(e){return t=e,null}},zg.mirror_to_cookie=function(e,t,n){return zg.cookies[t]={value:JSON.stringify(e),...n}},Number.prototype.nanos=function(){return this.micros()/1e3},Number.prototype.micros=function(){return this.millis()/1e3},Number.prototype.millis=function(){return this.seconds()/1e3},Number.prototype.seconds=function(){return this},Number.prototype.minutes=function(){return this.seconds()*60},Number.prototype.hours=function(){return this.minutes()*60},Number.prototype.days=function(){return this.hours()*24},Number.prototype.months=function(){return this.days()*30.43684914},Number.prototype.years=function(){return this.months()*12},Number.prototype.ago=function(){return new Date(Date.now()-this*1e3)},Number.prototype.fromnow=function(){return new Date(Date.now()+this*1e3)},create_math_function=function(e){return function(){return this(Math[e])}},ref=Object.getOwnPropertyNames(Math);for(i=0,len=ref.length;i<len;i++)key=ref[i],fun=Math[key],fun.length===1&&typeof fun=="function"&&eval(`Number.prototype.${key} = function() {return Math.${key}(this)}`);zg.stream={},zg.HttpException=class HttpException extends Error{constructor(e){super(`Recieved code ${e} from server`),this.status=e}},zg.stream.text=async function*(e,t){if(n=await fetch(e,t),!n.ok)throw new zg.HttpException(n.statusCode);for(var n,s,o,a=n.body.getReader(),i=new TextDecoder;!0;)if(o=await a.read(),s=i.decode(o.value),s.length>0&&(yield s),o.done)return},zg.stream.lines=async function*(e,t){var n,s,o,a,r,c,i="",l=zg.stream.text(e,t);for await(r of l)i+=r,n=i.split(`
`),n.length>1&&(yield n[0],n=n.slice(1),i=n.join(`
`));o=[];for(s=0,c=n.length;s<c;s++)a=n[s],a.length>0?o.push(yield a):o.push(void 0);return o},zg.stream.jsonl=async function*(e,t){var n,o=zg.stream.lines(e,t),s=[];for await(n of o)try{s.push(yield JSON.parse(n))}catch{}return s},zg.create=function(e,t){var n,s=zg.queryone("zg-template#"+e);if(s==null)throw new TypeError("no such template with name "+e);return n=function(e,t){var s,o,i,a,r,c,l,d,m=e.cloneNode(!0),u=[],h=m.childNodes;for(o=0,l=h.length;o<l;o++){switch(s=h[o],a=function(e){return e.replace(/\\?\$\{(.+?)\}/g,function(e,n){return e.startsWith("\\")?e:zg.deepfind(t,n)})},s.nodeName.toLowerCase()){case"zg-var":s=document.createTextNode(zg.deepfind(t,s.innerHTML))}if(s.nodeName==="#text")s.data=a(s.data);else{c=s.attributes;for(i=0,d=c.length;i<d;i++)r=c[i],s.attributes[r]=a(s.attributes[r]);s.innerText=a(s.innerText)}s.children!=null&&s.replaceChildren(...n(s,t)),u.push(s)}return u},HTML.div(n(s,t))}